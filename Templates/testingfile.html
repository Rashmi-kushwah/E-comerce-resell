
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


    <link rel="stylesheet" href="">
    
    <style>
        *{
            margin: 0;
            padding: 0;
            font-family: sans-serif;
            
            
        }
        .hero{
           
            margin-top: 30px;
           height: 100vh;
          
           
           

        }
        .row{
            
          
          
            width: 100%;
            margin: 10px;
        
            display: flex;
            align-items: center;
            justify-content: space-between;
            
        }
        .row1{
            
          
          
            width: 100%;
            margin: 10px;
        
            display: flex;
            align-items: center;
            justify-content: space-between;
            
        }
       
       
      
        .slider {
   
    display: flex;
   
}

    .product img {
    height: 17vh;
    margin-bottom: 8px;
    cursor: pointer;
    display: block; /* Add this line */
}
.col {
    padding-left: 20px; /* Current padding */
    padding-right: 100px; /* Add padding-right to increase the gap */
}
.content{
  
}
.main1{
          color: #fe980f;
          border-radius: 5px;
          width: 100px;
          margin-top: 3px;
          font-weight: bold;
          


          } 
    .brand{
        
            background: #008000;
            width: fit-content;
            color: #fff;
            font-size: 12px;
            padding: 2px 5px;
        }
        h3{
            font-size: 45px;
            color: #555;
            margin-bottom: 20px;

        }
        .rating{
                font-weight: 600;
                color: #ffc107;
            }
            .price{
             color: #fe980f;
             font-size: 26px;
             font-weight: bold;
             padding-top: 10px;
            }
     button {
            font-size: 16px;
            padding: 15px 60px;
            margin-top: 30px;
            cursor: pointer;
            border: 0;
            outline: none;
            color: #fff;
            box-shadow: 0 4px 6px 0 rgb(0, 0, 0, 0, 0.12);
        }
        input{
            width: 30px;
            border: 1px solid #ccc;
            font-weight: bold;
            text-align: center;
        }
      .buy {
            background-color: #ff9f00;
        }

        .cart {
            background-color: #fb641b;
            margin-left: 10px;
        }
        .related{
           
            width: 90%;
            margin: 0 auto 40px;
        }
      
        .related,.row{
            width: 100%;
            height: auto;
        }
        .related h2{
            margin-left: 20px;
        }
        .column{
            flex-basis: 22%;
            height: 100%;
        }
        .items img{
            width: 100%;
        }
        .details {
            margin-top: 20px;
        }
        .details p{
            font-size: 14px;
            margin-bottom: 10px;
        }
  
        select[name="size"] {
    width: 150px; /* Set the width of the dropdown */
    padding: 10px; /* Add padding */
    border: 1px solid rgb(255,215,0);
    border-radius: 5px; /* Add border radius */
    font-size: 16px; /* Set font size */
    outline: none; /* Remove default focus outline */
    background-color: #fff; /* Set background color */
    color: #333; /* Set text color */
}

/* Style the dropdown arrow */
select[name="size"]::after {
    content: '\25BC'; /* Unicode character for down arrow */
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);
    pointer-events: none;
}
label{
              margin-bottom: 10px;
            }
            select{
              padding: 10px;
              width: 150px;
              font-size: 16px;
              border-radius: 10px;
              border: 1px solid rgb(255,215,0);
            }



.original {
    cursor: crosshair;
    position: relative; /* Add this line */
}

.original img {
    height: 100%;
    margin-left: 10px;
   
}

/*  */
#target {



}
.zoom, .original {
  position: relative;
}

.zoom {
   
  display: inline-block;
}

.zoom .viewer {
  position: absolute;
  top: 0;
  left: 100%;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

.zoom .viewer img {
    width: 100%;
  position: absolute;
  margin-left: 30px;
}

.original:hover ~ div {
  display: block;
 
}

.original::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 1;
  
}
.magnifier {
  position: absolute;
  background: #000;
  opacity: 0.7;
  top: 0;
  left: 0;

}

.magnifier, .viewer {
  display: none;
}

.product-details h2 {
              font-size: 24px;
              margin-bottom: 10px;
            }

            .product-details p {
              font-size: 16px;
              margin-bottom: 15px;
            }

            .product-details button {
              padding: 10px 20px;
              font-size: 16px;
              margin-inline: 10px;
              background-color: rgb(252, 162, 52);
              color: #fff;
              border: none;
              border-radius: 4px;
              cursor: pointer;
              transition: background-color 0.3s;
            }
         
            .product-details button:hover {
              background-color: #2980b9;
            }
            @media (max-width: 768px) {
    /* Chhote screens ke liye styles ko adjust karein */
    .hero {
   
        margin-top: 10px; 
        flex-direction: row;
        justify-content: center;
        align-items: center;

    }
   .product-details{

   }
    .col {
        width: 100%;
       
    }
    .slider {

    }
   
    .row {
        width: 100%;
        flex-direction: column; /* Column layout set karein */
       
    }
    .row1 {
     
     margin-left: 10px;
       
    }
   
   
.original img{
    width:270px;
    height: 480px;
   /* height: 60vh; */
   border: 1px solid rgb(179, 173, 173);
    margin-right: 100px; /* Right margin ko kam kar diya */
}
.related h2{
font-size: 22px;
}
.product img {
    height: 10.3vh;
    border: 1px solid rgb(179, 173, 173);
        margin-bottom: 7px; /* Bottom margin ko de dein */
    }
    button {
            font-size: 16px;
            padding: 15px 60px;
            margin-top: 40px;
            cursor: pointer;
            border: 0;
            outline: none;
            color: #fff;
            box-shadow: 0 4px 6px 0 rgb(0, 0, 0, 0, 0.12);
        }
        input{
           width: 30%;
        }
    
    /* Chhote screens ke liye styles ko adjust karein */
    button {
        padding: 10px 46px; /* Example padding ko adjust kiya gaya hai */
        margin-top: 20px; /* Example margin ko adjust kiya gaya hai */
    }
    select[name="sizes"],
    select[name="qty"] {
        display: block; /* Display ko block set karein */
        width:35%; /* Full width set karein */
        margin-bottom: 10px; /* Bottom margin diya gaya hai */
    }
}
@media (max-width: 768px) {
  .column {
    width: 48%; /* Change the width to 48% to accommodate two columns per row */
  }
}


    






    </style>
   
    </head>
    <body>
       
            

            <div class="hero">
            {% for product in get_product %}
            <div class="zoom">
                <div class="row">
                    <div class="col">
                        <div class="slider">
                            <div class="product">
                                <img src="{{product.img1}}" alt="">
                                <img src="{{product.img2}}" alt="">
                                <img src="{{product.img3}}" alt="">
                                <img src="{{product.img4}}" alt="">
                                <img  src="{{product.img5}}" alt="">
                              <img  src="{{product.img6}}" alt="">
                            
                                
                               
                           
                            </div>
                       
                                <!-- Small Image -->
                               
                                <div class="original">
                                    
                                    <img src="{{product.img1}}" id="target">
                                </div>
                        
                                </div>
                                </div>
                                
                                
                               

                            <!-- Large Image
                            <div class="viewer">
                                <img src="{{product.img2}}">
                                             <!-- Magnifier Effect 
                    </div>
                            
                    <div class="magnifier">
                        
                    
                    </div> -->
                           
               

                        <div class="col">
                            <div class="content">
                                <p class="brand" >Brand:   {{product.brand}}</p>
                                <p  style="font-size: 28px;">{{product.sub_title}}</p>
                                <h2 style="color: green; font-weight: bold; font-size: 15px;">{{product.title}}</h2>
                                <div class="rating">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-half-o"></i>
                                    <i class="fa fa-star-o"></i>
                                </div>
                                
                            

                            
                                    
                            <div class="product-details">
                                <br>
                            
                                <h4>Product details:</h4>
                                
                                <h5>Price: &#8377 {{product.price}}</h5>
                                <del style="color: red;">&#8377 MRP {{product.mrp}} </del>
                              <!-- <p >{{product.sub_title}}</p>--> 
                               <p >Brand:{{product.brand}}</p>
                                <p>pattern:{{product.pattern}}</p>
                                <p>Color : {{product.color}}</p>
                                <p>Neckline : {{product.neckline}}</p>
                                <p>sleeve_length: {{product.sleeve_length}}</p>
                                <p>occasion: {{product.occasion}}</p>
                                <p>material: {{product.material}}</p>
                                <p>net_quantity: {{product.net_quantity}}</p>
                               <!--<p>net_quantity: {{product.description}}</p>--> 
                            
                            
                        
                            
                            </div>
                            <h6>More Information---------</h6>
          
                                    <form method="POST" action="/addcart/">
                                        {% csrf_token %}
                                    <label for="size">Size</label>
                                        <select name="sizes" id="size" class="sl" required>
                                        <option value="">Select size </option>
                                        <option value="{{product.size1}}">{{product.size1}}</option>
                                        <option value="{{product.size1}}">{{product.size2}}</option>
                                        <option value="{{product.size1}}">{{product.size3}}</option>
                                        </select>
                                       
                                        <label for="size">Quantity</label>
                                        <select name="qty" id="qty" required>
                                        <option value="">Select qty</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                    
                                        
                                    </select>  
                        
                            <div>
                                    <br><br>
                                    {% if msg %}
                                    <h3>{{msg}}</h3>
                                    {% endif %}
                                
                                
                                
                                            <button class="buy" name="buy_id" id="buyNowBtn" value="{{product.Product_id}}">Buy Now</button>
                                        
                                        <button class="cart" name="product_id" id="addToCartBtn" value="{{product.Product_id}}">
                                            <i class="fa fa-shopping-cart"></i> Add Cart</button>
                                        
                                    </form>
                           
                            
                        </div>
                    
          
          
      
            {% endfor %}

          </div>
          </div>
          </div>
     
       
            <h2 style="margin-top: 70px; margin-left: 20px;">related items</h2>
        <div class="row1">
          {% for p in products %}
            <div class="column">
           
                <div class="items">
                  <a href="{% url 'productdt' product_id=p.Product_id %}">
                    <img src="{{p.img1}}" alt="">
                  </a>
                    <div class="details">
                        <p style="color:black; font-size: 16px; font-weight: bold;" > {{ p.sub_title}} </p>
                        <div class="rating">
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star-half-o"></i>
                            <i class="fa fa-star-o"></i>
                        </div>
                        <p>
                          <span><b>&#8377 {{ p.price }}</b><del style="color: rgb(255, 0, 0) ;margin-inline: 10px; margin-top: 3px;">&#8377 MRP {{ p.mrp }}</del></span>
                        </p>
                        <div class="main1"> <p class="discount_{{p.Product_id}}"></p></div>
                        <p style="color: green; font-weight: bold;font-size: 16px;"> {{ p.title }}</p>
                    </div>
                </div>
            </div>
            <script>
                var price = parseFloat('{{ p.price }}');
                var mrp = parseFloat('{{ p.mrp }}');
    
                var percentageDiscount = ((mrp - price) / mrp) * 100;
    
                document.querySelector(".discount_{{p.Product_id}}").innerHTML =  percentageDiscount.toFixed(0) + "%" + " Margin" ;
            </script>
            {% endfor %}

 

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-zoom/1.7.21/jquery.zoom.min.js"></script>

    <script src="C:\Users\rashm\Downloads\product-image-magnifier-hover\product-image-magnifier-hover\js\zoom.js"></script> <!-- Replace with the actual path -->
 

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var sizeSelect = document.getElementById("size");
            var quantityInput = document.getElementById("quantity");
            var addToCartBtn = document.getElementById("addToCartBtn");
            var buyNowBtn = document.getElementById("buyNowBtn");

            function checkFields() {
                var sizeValue = sizeSelect.value;
                var quantityValue = quantityInput.value;

                if (sizeValue !== "select-size" && quantityValue > 0) {
                    addToCartBtn.removeAttribute("disabled");
                    buyNowBtn.removeAttribute("disabled");
                } else {
                    addToCartBtn.setAttribute("disabled", true);
                    buyNowBtn.setAttribute("disabled", true);
                }
            }

            sizeSelect.addEventListener("change", checkFields);
            quantityInput.addEventListener("input", checkFields);
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Chhoti images ke references ko lete hain
            var smallImages = document.querySelectorAll('.product img');
    
            // Har chhoti image per event listener lagate hain
            smallImages.forEach(function(img) {
                img.addEventListener('click', function() {
                    // Main image ka source ko chhoti image ke source se badal dete hain
                    document.getElementById('target').src = this.src;
                });
            });
        });
    </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-zoom/1.7.21/jquery.zoom.min.js"></script>
        <script>
            $(document).ready(function() {
                var zoomInstance = $('#target').zoom(); // Initialize the zoom plugin
                zoomInstance.setZoom(5); // Set zoom level
            });
        </script>
 <script>
    
 </script>
  
    

    
    </html>





    from django.shortcuts import render
    from django.http import HttpResponse
    from django.shortcuts import render, redirect
    from django.http import HttpResponseRedirect
    from  ecomUser.models import User
    from PRODUCTDT.models import Productdt
    from CARTPRODUCT.models import addcart
    from Orders.models import Order
    
    
    
    def youtube(request):
        return render(request,'you tube clone.html')
    
    def video(request):
        return render(request,'Video-play.html')
    def meesho(request):
        return render(request,'meesho.html')
    def home(request):
        return HttpResponse('welcome to homepage')  # Udaharan view function
    '''
    def header(request):
        return render(request,"header.html")  
    '''
    def footer(request):
        return render(request,"footer.html")  
    def otp(request):
        return render(request,"otp page.html")
    
    
    def cart_count(request):
        user_id = request.session.get('user_uid')
        cart_product = addcart.objects.filter(user_uid=user_id)
        cart_count = cart_product.count()
        print(cart_count )
        return render(request, 'header.html', {'cart_count': cart_count})
        
    
    
    def homepage(request):
      #  try:
          
         #   user = User.objects.get(user_uid=user_id)
            user_id = request.session.get('user_uid')
            cart_product = addcart.objects.filter(user_uid=user_id)
            cart_count = cart_product.count()
            print(cart_count )
            
            
            all_products = Productdt.objects.all()
    
            data = {
                
                    'products': all_products,
                    'cart_count': cart_count
                }
    
            return render(request, 'homepage.html', data)
        
     #   except:
     #       return redirect('/?message=Please login') 
       
       
    def login(request):
        
    
        if 'message' in request.GET:
            msg= request.GET['message']
    
        else:
            msg=None
            
    
        if request.method == 'POST':
            
            email = request.POST.get('email')
            print(email)
            
            password = request.POST.get('password')
            print(password)
            try:
                user = User.objects.get(email=email)
                if password == user.password:  
                    request.session['user_uid'] = str(user.user_uid)
                    print('check')
                    return redirect('/homepage/')
    
                else:
                    print('no check')
                    return render(request, 'login.html', {'error': 'Invalid email or password'})    
          
            except User.DoesNotExist:
    
                return render(request, 'login.html',{'error': 'Email id is not registered'})
        else:
            return render(request, 'login.html',{'error':msg})
    
    
    def register(request):   
        if request.method == 'POST':
            name = request.POST.get('name')
            phone_number  = request.POST.get('mo')
            email = request.POST.get('email')
            password = request.POST.get('pass')
            
            try:
                user = User.objects.get(email = email)
                return render(request, 'register.html', {'error': 'Email address already registered.'})
            
            except :
                otp = send_otp_email(email)
              #  otp = 1234
                request.session['email'] = email
                # Create user instance
                
                user = User.objects.create(
                    Name=name,
                    phone_number =phone_number ,
                    email=email,
                    password=password,
                    otp=otp  # Set OTP value in the user instance
                )
                user.save()  # Save the user instance with OTP
             #   return HttpResponse("save")
                return redirect('/otp/verify/')
        else:
            return render(request, 'register.html')
    
    from django.core.mail import send_mail
    from django.utils.crypto import get_random_string
    
    def send_otp_email(email):
        otp = get_random_string(length=6, allowed_chars='1234567890')
        subject = 'Your OTP for ECOMERCEPROJECT'
        message = f'Your OTP is: {otp}'
        from_email = 'rashmiinfo6@gmail.com'  # Your email ID
        recipient_list = [email]
        
        send_mail(subject, message, from_email, recipient_list)
        print('send email ')
        
        return otp
    
    def otp_verify(request):
        if request.method == 'POST':
            otp = request.POST.get('otp')
            email = request.session.get('email')
            print(email)
            user = User.objects.get(email=email)
            if otp == user.otp: 
                
                return redirect('/?message=verification successful') 
            else:
                return render(request,'otp page.html',{'error': 'invalid otp'})    
    
        return render(request,'otp page.html')    
            
    
    
            
    from django.contrib.auth import logout
    
    
    def logout(request):
        try:
                user_id = request.session.get('user_uid')
                print(user_id)
                user = User.objects.get(user_uid=user_id)
                print(user)
             #  user_id = request.session.get('user_uid')
             #   print(user_id)
                if user_id:
                    try:
                        user = User.objects.get(user_uid=user_id)
                        print(user)
                        user.delete()  
                        del request.session['user_uid']
                        
                        return HttpResponse('User data deleted successfully.')
                    except User.DoesNotExist:
                        pass 
    
                    return HttpResponse('No user data found to delete.')
        except:
                return redirect('/?message=Please login')
    
    
    
    def category(request):
            try:
                user_id = request.session.get('user_uid')
                print(user_id)
                user = User.objects.get(user_uid=user_id)
                print(user)
            
                #  if request.method == 'POST':
                value = request.GET.get('category_value')
                all_products = Productdt.objects.filter(name__icontains=value)
                print('data not found',all_products)
                user_id = request.session.get('user_uid')
                cart_product = addcart.objects.filter(user_uid=user_id)
                cart_count = cart_product.count()
                print(cart_count )
    
            
                data={
                        'products': all_products, 
                        'category': value  ,# Category ka data context mein add karen
                        'cart_count': cart_count,
                    }
            
                return render(request, 'category_page.html',data)
    
            except:
                return redirect('/?message=Please login')
    def search(request):
        try:
            user_id = request.session.get('user_uid')
            print(user_id)
            user = User.objects.get(user_uid=user_id)
            print(user)
            if request.method == 'POST':
                value = request.POST.get('search')
                print(value)
                all_products = Productdt.objects.filter(name__icontains=value)
                print(all_products)
            
                data={
                        'products': all_products, 
                        
                        'category': value  # Category ka data context mein add karen
                    }  
                return render(request, 'category_page.html',data)
            
        except:
                return redirect('/?message=Please login') 
    def category_type(request):
            try:
                user_id = request.session.get('user_uid')
                print(user_id)
                user = User.objects.get(user_uid=user_id)
                print(user)
            #  if request.method == 'POST':
                value = request.GET.get('category_value')
                all_products = Productdt.objects.filter(Category__icontains=value)
                print('data not found',all_products)
                user_id = request.session.get('user_uid')
                cart_product = addcart.objects.filter(user_uid=user_id)
                cart_count = cart_product.count()
                print(cart_count )
    
            
                data={
                        'products': all_products, 
                        'category': value  ,# Category ka data context mein add karen
                        'cart_count': cart_count,
                        'category': value  # Category ka data context mein add karen
                    }
            
                return render(request, 'category_page.html',data)
            except:
                return redirect('/?message=Please login') 
    ''' 
    
    def product_list(request):
        value = request.GET.get('category')
        
        all_products = Productdt.objects.filter(Category=value)
        print('data not found',all_products)
    
        data={
                 'products': all_products, 
                   'value':value
            }
    
    
    ''' 
    def productdt(request, product_id):
        try:
            user_id = request.session.get('user_uid')
            print(user_id)
            user = User.objects.get(user_uid=user_id)
            print(user)
            
            cart_product = addcart.objects.filter(user_uid=user_id)
            cart_count = cart_product.count()
            print(cart_count )
      
            # Product detail retrieve karne ke liye product_id ka use karein
            get_product_dt = Productdt.objects.filter(Product_id=product_id)
            print(get_product_dt)
            all_products = Productdt.objects.none()  # Default value
            value = None
            
            # Check if product is found with given product_id
            if get_product_dt.exists():
                # If found, retrieve model_name of first product
                value = get_product_dt.first().Model_name
            
                # Check if model_name is available
                if value is not None:
                    # If available, filter products based on model_name
                    all_products = Productdt.objects.filter(Model_name__icontains=value)
                #  print(all_products )
            
            # Pass the retrieved product details to the template
            return render(request, 'product page.html', {'get_product': get_product_dt, 'products': all_products, 'cart_count': cart_count,})
        except:
            return redirect('/?message=Please login') 
    
    
    
    
    
    
    def Addcart(request):
        try:
                user_id = request.session.get('user_uid')
                print(user_id)
                user = User.objects.get(user_uid=user_id)
                print(user)
                if request.method == 'POST':
                
                #  print("Session User ID:", user_id)
                    product_id = request.POST.get('product_id')
                    print("Add Product ID:", product_id)
                    buy_id = request.POST.get('buy_id')
                    print("Add buy ID:", buy_id)
                    size = request.POST.get('sizes')
                    print("Selected Size:", size)
                    qty = request.POST.get('qty')
                    print("Selected Quantity:", qty)
    
                # return HttpResponse('test')
                    try:
                        add_product_dt = Productdt.objects.get(Product_id=product_id)
    
                
                        total_amount = int(qty) * add_product_dt.price
                        print(total_amount)
                        # Create cart item
                        cart=addcart(
    
                            Product_id=product_id,
                        
                            user_uid =user_id ,
                            sku_code=add_product_dt.sku_code ,
                            title=add_product_dt.title,
                            color =add_product_dt.color,
                            img1= add_product_dt.img1,
                            qty =qty, 
                            size =size,
                            price =add_product_dt.price,
                            mrp =add_product_dt.mrp,
                            total_amount = str(total_amount),  # Save calculated total amount as an integer
                        
                            total_qty = qty,
                        
                        
                        
                        )
                        cart.save()
                        return redirect('productdt', product_id=product_id)
                    
                    except:
                        add_buy_dt = Productdt.objects.get(Product_id=buy_id)
    
                        # Calculate total amount based on quantity and price
                        total_amount = int(qty) * add_buy_dt.price
                        print(total_amount)
                        # Create cart item
                        cart=addcart(
    
                            Product_id=buy_id,
                        
                            user_uid =user_id ,
                            sku_code=add_buy_dt.sku_code ,
                            title=add_buy_dt.title,
                            color =add_buy_dt.color,
                            img1= add_buy_dt.img1,
                            qty =qty, 
                            size =size,
                            price =add_buy_dt.price,
                            mrp =add_buy_dt.mrp,
                            total_amount=total_amount,  # Save calculated total amount as an integer
                        
                            total_qty=qty,
                        
                            
                        
                        
                        
                        )
                        cart.save()
                    #  return HttpResponse('test')
                        return redirect('/cart/', product_id=buy_id)
    
              #  return HttpResponse('test')
    
                
            # Fetch product details again for rendering
           # get_product_dt = Productdt.objects.filter(Product_id=product_id)
    
            # Pass the product details to the template
          #  return render(request, 'Product page.html', {'product': get_product_dt, 'msg': 'Product is added to cart'})
    
        except:
            return redirect('/?message=Please login') 
    
    def cart(request):
        try:
            user_id = request.session.get('user_uid')
            print(user_id )
            user = User.objects.get(user_uid=user_id)
    
            
            cart_product = addcart.objects.filter(user_uid=user_id)
        
            if request.method == 'POST':
                margin = request.POST.get('margin')
                print('margin',margin)
                return redirect("/check_out/")
            
            price = 0
            qty1 = 0
            for p in cart_product:
                t = (p.total_amount)
                price = price + float(t)
                qty1 = qty1 + int(p.qty)
            
    
            data={
            
                'cart_product':cart_product,
                'total_price':price,
                'qty1':qty1
            }
        
            return render(request,'Shopping Cart.html',data)
        except:
           return redirect('/?message=Please login') 
    
    
    from django.shortcuts import redirect, get_object_or_404
    
    
    def remove_product(request):
        try:
            user_id = request.session.get('user_uid')
            print(user_id )
            user = User.objects.get(user_uid=user_id)
            print(user )
            if request.method == 'POST':
                remove_product_id = request.POST.get('remove')
            
                remove_id = get_object_or_404(addcart, id=remove_product_id)
                remove_id.delete()
                return redirect('/cart/')
       #return  HttpResponse('remove product')
        except:
            return redirect('/?message=Please login') 
    
    
    from django.shortcuts import render
    from django.http import HttpResponseRedirect
    from Orders.models import Order
    
    
    from datetime import datetime
    import uuid
    
    
    import uuid
    from datetime import datetime
    from django.shortcuts import render, redirect
    #from .models import Order  # Import your Order model
    
    def check_out(request):
        try:
            user_id = request.session.get('user_uid')
            print(user_id )
            user = User.objects.get(user_uid=user_id)
            print(user)
           
            cart_products = addcart.objects.filter(user_uid=user_id)
            
            if request.method == 'POST':
                    margin = request.POST.get('margin')
                    print('margin',margin)  
                # Redirect to a confirmation page or any other desired page
            #  return redirect('confirmation_page')  # Adjust the URL name as needed
    
            return render(request, 'check_out_page.html')  # Render the checkout page if not POST request
    
        
          #  return render(request, 'check_out page.html')
        except:
            return redirect('/?message=Please login') 
    
    
    
    
    from django.shortcuts import render, HttpResponse
    
    from datetime import datetime
    import uuid
    
    def confirm_order(request):
        try:
          
            user_id = request.session.get('user_uid')
            print('user_id',user_id)
            user = User.objects.get(user_uid = user_id )
            print('user',user)
            cart_products = addcart.objects.filter(user_uid=user_id)
            email = request.POST.get('email')
            print("email_id",email)
            
            if request.method == 'POST':
                
                firstName = request.POST.get('firstName')
                phone_number = request.POST.get('phone')
                address = request.POST.get('address')
                pincode = request.POST.get('pincode')
                landmark = request.POST.get('landmark')
                state = request.POST.get('state')
                
                order_id = str(uuid.uuid4().hex[:10])
                order_date = datetime.now()
                
                for o in cart_products:
                    product_id = o.Product_id
                    
                    order = Order(
                        email= user.email , 
                        user_uid=user_id,  # Assign user_id to user_uid field
                        Product_id=product_id,
                        name=firstName,
                        phone_number=phone_number,
                        address=address,
                        pincode=pincode,
                        landmark=landmark,
                        state=state,
                        order_id=order_id,
                        order_date=order_date,
                        order_status="",
                        tracking_id="",
                        tracking_link="",
                    )
                    order.save()
                
              #  return HttpResponse('Order data saved successfully')  # Return a response indicating success
                return redirect('/order_detail_page/')
            
            return render(request, 'Confirm Order.html')  # Render the confirm order page
    
        except:
            return redirect('/')
    
    
    
    def order_detail_page(request):
        try:
            user_id = request.session.get('user_uid')
            orders = Order.objects.filter(user_uid=user_id)
         #   email = request.session.get('email')
         #   print("email_id",email)
           
         
           
         
            return render(request, 'order_detailpage.html', {'orders': orders,'error':'Thank you for shoppiong with us!'})
    
        
        except:
      
          return redirect('/')
        
    '''
    def profile(request):
     #   try:
            user_id = request.session.get('user_uid')
            user_data = User.objects.filter(user_uid = user_id)
            # user_data = User.objects.all()
            cart_product = addcart.objects.filter(user_uid=user_id)
            cart_count = cart_product.count()
            print(cart_count )
            
            data={
                'user_data': user_data,
                'cart_count': cart_count
                
            }
            return render(request,'profile.html',data)
    
       # except:
       #     return redirect('/?message=Please login') 
    '''
    
    
    
    def profile(request):
        try:
            user_id = request.session.get('user_uid')
            user_data = User.objects.filter(user_uid=user_id)
         
            cart_product = addcart.objects.filter(user_uid=user_id)
            cart_count = cart_product.count()
    
          
            total_order_count = Order.objects.filter(user_uid=user_id).count()
            print('total_order_count',total_order_count)
    
            new_order_count = Order.objects.filter(user_uid=user_id, order_status='New').count()
            print('new_order_count',new_order_count)
    
            delivered_order_count = Order.objects.filter(user_uid=user_id, order_status='delivered').count()
            print('delivered_order_count',delivered_order_count)
    
            shipped_order_count = Order.objects.filter(user_uid=user_id, order_status='Shipped').count()
            print('shipped_order_count',shipped_order_count)
    
            canceled_order_count = Order.objects.filter(user_uid=user_id, order_status='Canceled').count()
            print('canceled_order_count',canceled_order_count)
    
            data = {
                'user_data': user_data,
                'cart_count': cart_count,
                'total_order_count': total_order_count,
                'new_order_count': new_order_count,
                'delivered_order_count': delivered_order_count,
                'shipped_order_count': shipped_order_count,
                'canceled_order_count': canceled_order_count
            }
            return render(request, 'profile.html', data)
        except:
            return redirect('/?message=Please login') 
    '''
    
    def order_status(request):
        orders = Order.objects.all()
        total_orders = orders.count()
        new_orders = orders.filter(order_status='New').count()
        cancelled_orders = orders.filter(order_status='Cancelled').count()
    
        return render(request, 'cancel order.html', {
            'total_orders': total_orders,
            'new_orders': new_orders,
            'cancelled_orders': cancelled_orders,
            'orders': orders
        })
    
    def all_orders(request):
        # Retrieve all orders for the current user
        user_id = request.session.get('user_uid')
        all_orders = Order.objects.filter(user_uid=user_id, order_status='all order')
        print('all_orders',all_orders)
        
        # Count the total number of orders
        total_order_count = all_orders.count()
        print('total_order_count:',total_order_count)
        
        return render(request, 'all_order.html', {'all_orders': all_orders, 'total_order_count': total_order_count})
    
    def new_orders(request):
        # Retrieve orders for the current user
        user_id = request.session.get('user_uid')
        print('uer_id',user_id)
        orders = Order.objects.filter(user_uid=user_id, order_status='new_orders')
        print('new orders',orders)
    
        new_order_count = orders.count()
        print('new_order_count:',new_order_count)
      #  return HttpResponse('your user_id has ben track')
        
        return render(request, 'all_order.html', {'orders': orders,'new_order_count': new_order_count})
    
    
    def delivered_orders(request):
        # Retrieve delivered orders
        user_id = request.session.get('user_uid')
        delivered_orders = Order.objects.filter(user_uid=user_id, order_status='delivered_order')
        print('delivered_orders:',delivered_orders)
        # Count the number of delivered orders
        delivered_order_count = delivered_orders.count()
        print('delivered_order_count:',delivered_order_count)
        return render(request, 'all_order.html', {'delivered_orders': delivered_orders, 'delivered_order_count': delivered_order_count})
    def shipped_orders(request):
        user_id = request.session.get('user_uid')
        print('uer_id:',user_id)
        shipped_orders = Order.objects.filter(user_uid=user_id, order_status='shipped_orders')
        print('shipped_orders:',shipped_orders)
    
        shipped_order_count = shipped_orders.count()
        print('shipped_order_count:',shipped_order_count)
        return render(request, 'all_order.html', {'shipped_orders': shipped_orders,'shipped_order_count':shipped_order_count})
    
    
    
    def cancel_orders(request):
        # Retrieve canceled orders for the current user
        user_id = request.session.get('user_uid')
        canceled_orders = Order.objects.filter(user_uid=user_id, order_status='cancel_orders')
        print('canceled_orders:',canceled_orders)
        
        # Count the number of canceled orders
        canceled_order_count = canceled_orders.count()
        print('canceled_order_count',canceled_order_count)
        
        return render(request, 'all_order.html', {'canceled_orders': canceled_orders, 'canceled_order_count': canceled_order_count})
    
    
        
    
    # all orders
    
    def all_orders(request):
        # Retrieve all orders for the current user
        user_id = request.session.get('user_uid')
        print('user_id',user_id)
        all_orders = Order.objects.filter(user_uid=user_id)
        print('all_orders',all_orders)
        
        # Count the total number of orders
        total_order_count = all_orders.count()
        print('total_order_count:',total_order_count)
        
        return render(request, 'all_order.html', {'all_orders': all_orders, 'total_order_count': total_order_count})    
    '''
    
    def all_orders(request):
        
        user_id = request.session.get('user_uid')
        print('user_id',user_id)
        all_orders = Order.objects.all()
        print('all_orders',all_orders)
        
      
        total_order_count = all_orders.count()
        print('total_order_count:',total_order_count)
        
        return render(request, 'all_order.html', {'orders': all_orders, 'total_order_count': total_order_count})
    
    
    
    def new_orders(request):
    
        user_id = request.session.get('user_uid')
        print('user_id', user_id)
        new_orders = Order.objects.filter(user_uid=user_id, order_status="New")
        print('new_orders',new_orders)
        new_order_count = new_orders.count()
        print('new_order_count:', new_order_count)
        
        return render(request, 'all_order.html', {'orders': new_orders, 'new_order_count': new_order_count})
    
    
    def delivered_orders(request):
        
        user_id = request.session.get('user_uid')
        print('user_id',user_id)
        delivered_orders = Order.objects.filter(user_uid=user_id, order_status='delivered')
        print('delivered_orders:',delivered_orders)
        
        delivered_order_count = delivered_orders.count()
        print('delivered_order_count:',delivered_order_count)
        return render(request, 'all_order.html', {'orders': delivered_orders, 'delivered_order_count': delivered_order_count})
    
    
    def shipped_orders(request):
        user_id = request.session.get('user_uid')
        print('user_id',user_id)
       
        shipped_orders = Order.objects.filter(user_uid=user_id, order_status='shipped')
        print('shipped_orders:',shipped_orders)
    
        shipped_order_count = shipped_orders.count()
        print('shipped_order_count:',shipped_order_count)
        return render(request, 'all_order.html', {'orders': shipped_orders,'shipped_order_count':shipped_order_count})
    
    
    
    def cancel_orders(request):
    
        user_id = request.session.get('user_uid')
        canceled_orders = Order.objects.filter(user_uid=user_id, order_status='Canceled')
        print('canceled_orders:',canceled_orders)
        
    
        canceled_order_count = canceled_orders.count()
        print('canceled_order_count',canceled_order_count)
        
        return render(request, 'all_order.html', {'orders': canceled_orders, 'canceled_order_count': canceled_order_count})
    
    
    